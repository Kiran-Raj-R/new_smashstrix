{% extends 'adminpanel/base_admin.html' %}
{% block title %}Products | SmashStrix{% endblock %}

{% block content %}

<div class="flex justify-between items-center mb-6">
  <h2 class="text-2xl font-bold">Products</h2>

  <a href="{% url 'admin_product_add' %}"
     class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800 transition">
     Add Product
  </a>
</div>

<form method="GET" class="flex gap-2 mb-4">
  <input type="text" name="search" value="{{ search }}"
         placeholder="Search Product..." class="border p-2 rounded w-64">
  <button class="bg-blue-700 text-white px-3 py-2 rounded">Search</button>
  <a href="{% url 'admin_products' %}"
     class="bg-gray-500 text-white px-3 py-2 rounded">Clear</a>
</form>

<table class="w-full bg-white shadow-md rounded">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-3 text-left">Image</th>
      <th class="p-3 text-left">Name</th>
      <th class="p-3 text-left">Brand</th>
      <th class="p-3 text-left">Category</th>
      <th class="p-3 text-left">Price</th>
      <th class="p-3 text-left">Status</th>
      <th class="p-3 text-left">Actions</th>
    </tr>
  </thead>

  <tbody>
    {% for product in products %}
    <tr class="border-b">

      <td class="p-3">
        {% if product.images.first %}
          <img src="{{ product.images.first.image.url }}"
               class="h-10 w-10 object-cover rounded">
        {% else %}
          —
        {% endif %}
      </td>

      <td class="p-3">{{ product.name }}</td>
      <td class="p-3">{{ product.brand.name }}</td>
      <td class="p-3">{{ product.category.name }}</td>

      <td class="p-3">
        ₹{{ product.discount_price|default:product.price }}
      </td>

      <td class="p-3">
        {% if product.active %}
          <span class="text-green-600 font-semibold">Active</span>
        {% else %}
          <span class="text-red-600 font-semibold">Inactive</span>
        {% endif %}
      </td>

      <td class="p-3 flex gap-4">
        <a href="{% url 'admin_product_edit' product.id %}"
           class="text-blue-600 hover:underline">Edit</a>

        <a href="{% url 'admin_product_delete' product.id %}"
           class="text-red-600 hover:underline"
           onclick="return confirm('Are you sure?')">Delete</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="mt-4 flex items-center gap-4">
  {% if products.has_previous %}
    <a href="?page={{ products.previous_page_number }}" class="px-3 py-1 bg-gray-300 rounded">Prev</a>
  {% endif %}

  <span>Page {{ products.number }} of {{ products.paginator.num_pages }}</span>

  {% if products.has_next %}
    <a href="?page={{ products.next_page_number }}" class="px-3 py-1 bg-gray-300 rounded">Next</a>
  {% endif %}
</div>

{% endblock %}
