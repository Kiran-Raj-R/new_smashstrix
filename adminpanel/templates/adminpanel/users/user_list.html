{% extends 'adminpanel/base_admin.html' %}
{% block title %}Users | SmashStrix{% endblock %}

{% block content %}

<div class="flex justify-between items-center mb-6">
  <h2 class="text-2xl font-bold">Users</h2>
</div>

<form method="GET" class="flex gap-2 mb-4">
  <input type="text" name="search" value="{{ search }}"
         placeholder="Search by email..."
         class="border p-2 rounded w-72">

  <button class="bg-blue-700 text-white px-4 py-2 rounded hover:bg-blue-800">Search</button>

  <a href="{% url 'admin_users' %}"
     class="bg-gray-500 text-white px-4 py-2 rounded">Clear</a>
</form>

<table class="w-full bg-white shadow-md rounded">
  <thead class="bg-gray-100">
    <tr>
      <th class="p-3 text-left">Email</th>
      <th class="p-3 text-left">Name</th>
      <th class="p-3 text-left">Mobile</th>
      <th class="p-3 text-left">Joined</th>
      <th class="p-3 text-left">Status</th>
      <th class="p-3 text-left">Actions</th>
    </tr>
  </thead>

  <tbody>
    {% for u in users %}
    <tr class="border-b">

      <td class="p-3">{{ u.email }}</td>
      <td class="p-3">{{ u.first_name }} {{ u.last_name }}</td>
      <td class="p-3">{{ u.mobile }}</td>
      <td class="p-3">{{ u.date_joined|date:"d M Y" }}</td>

      <td class="p-3">
        {% if u.blocked %}
          <span class="text-red-600 font-semibold">Blocked</span>
        {% else %}
          <span class="text-green-600 font-semibold">Active</span>
        {% endif %}
      </td>

      <td class="p-3">
        {% if u.blocked %}
          <a href="{% url 'admin_unblock_user' u.id %}" class="text-green-600 hover:underline"> Unblock</a>
        {% else %}
          <a href="{% url 'admin_block_user' u.id %}" onclick="return confirm('Block this user?')" class="text-red-600 hover:underline"> Block</a>
        {% endif %}
      </td>

    </tr>
    {% endfor %}
  </tbody>
</table>

<div class="mt-4 flex items-center gap-4">
  {% if users.has_previous %}
    <a href="?page={{ users.previous_page_number }}" class="px-3 py-1 bg-gray-300 rounded">
      Prev
    </a>
  {% endif %}

  <span>Page {{ users.number }} of {{ users.paginator.num_pages }}</span>

  {% if users.has_next %}
    <a href="?page={{ users.next_page_number }}" class="px-3 py-1 bg-gray-300 rounded">
      Next
    </a>
  {% endif %}
</div>

{% endblock %}
