{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mx-auto py-10">

  <h2 class="text-2xl font-bold mb-8">Order Details</h2>

  <div class="bg-white shadow rounded-xl border p-6 mb-8">

    <div class="grid md:grid-cols-2 gap-6">

      <div>
        <p class="text-sm text-gray-500">Order ID</p>
        <p class="font-semibold">{{ order.order_id }}</p>
      </div>

      <div>
        <p class="text-sm text-gray-500">Order Date</p>
        <p>{{ order.created_at|date:"d M Y, h:i A" }}</p>
      </div>

      <div>
        <p class="text-sm text-gray-500">Status</p>
        <span class="px-3 py-1 rounded-full text-sm font-medium
          {% if order.status == 'Pending' %}bg-yellow-100 text-yellow-700
          {% elif order.status == 'Processing' %}bg-blue-100 text-blue-700
          {% elif order.status == 'Shipped' %}bg-purple-100 text-purple-700
          {% elif order.status == 'Delivered' %}bg-green-100 text-green-700
          {% elif order.status == 'Cancelled' %}bg-red-100 text-red-700
          {% endif %}
        ">
          {{ order.status }}
        </span>
      </div>

      <div>
        <p class="text-sm text-gray-500">Payment Method</p>
        <p>{{ order.payment_method }}</p>
      </div>

    </div>
  </div>

  <!-- SHIPPING ADDRESS -->
  <div class="bg-white shadow rounded-xl border p-6 mb-8">
    <h3 class="text-lg font-semibold mb-4">Shipping Address</h3>

    <p class="font-semibold">{{ order.address.full_name }}</p>
    <p class="text-gray-600">
      {{ order.address.address_line1 }},
      {{ order.address.city }},
      {{ order.address.state }} -
      {{ order.address.pincode }}
    </p>
    <p class="text-gray-600">
      Phone: {{ order.address.phone }}
    </p>
  </div>

  <!-- ORDER ITEMS -->
  <div class="bg-white shadow rounded-xl border p-6 mb-8">
    <h3 class="text-lg font-semibold mb-6">Items</h3>

    <div class="space-y-6">
      {% for item in order_items %}
      <div class="flex items-center justify-between border-b pb-4">

        <div class="flex items-center gap-4">
          {% if item.product.images.first %}
          <img src="{{ item.product.images.first.image.url }}"
               class="w-20 h-20 object-cover rounded">
          {% endif %}

          <div>
            <p class="font-semibold">{{ item.product.name }}</p>
            <p class="text-sm text-gray-600">
              Color: {{ item.color_variant.color }}
            </p>
            <p class="text-sm text-gray-600">
              Quantity: {{ item.quantity }}
            </p>
          </div>
        </div>

        <div class="text-right">
          <p class="text-sm text-gray-500">
            ₹{{ item.price|floatformat:2 }} each
          </p>
          <p class="font-semibold text-green-700">
            ₹{{ item.total_price|floatformat:2 }}
          </p>
        </div>

      </div>
      {% endfor %}
    </div>
  </div>

  <!-- SUMMARY -->
  <div class="bg-white shadow rounded-xl border p-6">

    <h3 class="text-lg font-semibold mb-6">Order Summary</h3>

    <div class="space-y-3 text-sm">

      <div class="flex justify-between">
        <span>Subtotal</span>
        <span>₹{{ order.subtotal|floatformat:2 }}</span>
      </div>

      <div class="flex justify-between">
        <span>Tax</span>
        <span>₹{{ order.tax|floatformat:2 }}</span>
      </div>

      <div class="flex justify-between">
        <span>Shipping</span>
        <span>₹{{ order.shipping|floatformat:2 }}</span>
      </div>

      <hr>

      <div class="flex justify-between font-bold text-lg">
        <span>Total</span>
        <span class="text-green-700">
          ₹{{ order.total_amount|floatformat:2 }}
        </span>
      </div>

    </div>

  </div>

</div>
{% endblock %}